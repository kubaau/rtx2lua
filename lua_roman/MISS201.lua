-- Generation begin (https://github.com/kubaau/rtx2lua)

-- Original map script: MIS_0001.RTX

rttr:RegisterTranslations(
{
    de =
    {
        Diary   = 'Tagebuch',
        msg0    = 'Dritter Tag des zweiten Jahres.\n\n\nWir haben offensichtlich eine zweite Insel erreicht. Auch diese scheint unbewohnt zu sein. So langsam gehen aber die Werkzeugvorräte der guten alten Tortius zu Ende. Wir brauchen also eine Schlosserei.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh0   = 'Errichten Sie eine Schlosserei und dringen Sie ins Innere der Insel vor. Denken Sie an die Versorgung mit Nahrungsmitteln und Rohstoffen.',
        msg2    = 'Wir stießen ein wenig nach Norden vor und dabei auf einen Landsmann. Er ist der einzige Überlebende eines Schiffsunglücks und natürlich sehr froh, wieder Menschen zu begegnen. Aber auch wir hatten Glück dabei: Der Mann ist Brauer. Falls es doch einmal zu kriegerischen Auseinandersetzungen kommen sollte, wird das Bier den Mut unserer Leute schon heben. Zu einem Soldaten gehört halt mehr als ein Schild und ein Schwert! \n\nDer Mann berichtete uns auch von Ruinen, die er auf der Insel entdeckt hat. Wir müssen, fürchte ich, demnächst vorsichtiger sein.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh2   = 'Dringen Sie ins Innere der Insel vor. Denken Sie an die Versorgung mit Nahrungsmitteln und Rohstoffen.',
        msg4    = 'Wir haben eine Ruine entdeckt. Darin befanden sich Baupläne für eine Wachhütte. Jetzt können und sollten wir möglichst ebenfalls Befestigungen bauen. Ich habe immer mehr das Gefühl, daß wir nicht allein auf dieser Insel sind.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh4   = 'Dringen Sie ins Innere der Insel vor. Denken Sie an die Versorgung mit Nahrungsmitteln und Rohstoffen.',
        msg6    = 'In der Ruine eines Wachturms fanden wir die dazugehörigen Baupläne. Wo kommen diese Bauwerke her? Wer errichtete sie? Ich fürchte, mit dem Frieden ist es bald vorbei.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh6   = 'Dringen Sie ins Innere der Insel vor. Denken Sie an die Versorgung mit Nahrungsmitteln und Rohstoffen.',
        msg8    = 'Wer auch immer sich auf dieser Insel befindet oder befand, er versteht das Bauhandwerk. Wir fanden die Ruine einer gewaltigen Festung, deren Konstruktion höchst nachahmenswert erscheint. Unsere Gelehrten haben bereits einen Bauplan entworfen.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh8   = 'Dringen Sie ins Innere der Insel vor. Denken Sie an die Versorgung mit Nahrungsmitteln und Rohstoffen.',
        msg10   = '26. Tag des 3. Monats.\n\n\nMeine Befürchtungen haben weitere Nahrung erhalten. Meine Leute fanden eine Stoffpuppe und zwei Speerspitzen, wie sie bei nubischen Völkern üblich sind. Und diese Artefakte sehen nicht sehr alt aus.',
        msg12   = 'Unser Reich wächst und die Transportwege werden immer länger. Wir sollten ein Lagerhaus bauen, um schneller reagieren zu können.',
        msg14   = 'Tagebuch des Octavius.\n\nVierter Tag im vierten Monat des zweiten Jahres.\n\nEs war zu erwarten: Wir sind auf ein nubisches Volk getroffen. Zunächst verlief alles sehr friedlich. Sie erzählten uns sogar von ihrem Heiligtum, und schnell wurde klar, daß es sich dabei um eines dieser Tore handelt. Aber sie weigern sich, uns Zutritt zu ihrem Heiligtum zu gewähren. Wir werden darum kämpfen müssen.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh14  = 'Greifen Sie die Nubier an und suchen sie nach deren Tor.',
        msg16   = 'Die Nubier sind lausige Kämpfer, aber sie haben dieses Katapult. Wir müssen es zerstören. Vielleicht kommen wir dann auch an die Pläne, wie man so etwas baut.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh16  = 'Erobern Sie das Katapult und suchen Sie dann weiter nach dem Tor.',
        msg18   = '27. Tag im neunten Monat.\n\n\nWir haben den Kampf gewonnen und die Insel ist unser. Und wieder ist das Tor aktiv geworden. Ich bin gespannt, wohin die Reise jetzt geht. Aber die Inschrift auf diesem Tor ist wieder latinisch, und so hoffe ich, daß wir vielleicht auf jenem Pfad wandern, den unsere sagenhaften Vorfahren gingen, bis sie nach Rom kamen...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh18  = 'Sie haben diese Mission erfüllt. Das dritte Kapitel wartet schon auf Sie...',
    },
    en =
    {
        Diary   = 'Diary',
        msg0    = 'Third Day of the Second Year.\n\n\nWe have reached a second island which appears to be uninhabited. The stock of tools belonging to the good old Tortius is slowly being used up. We desperately need a metalworks to make new tools.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh0   = 'Build a metalworks and move into the interior of the island. Pay close attention to the supply of provisions and raw materials.',
        msg2    = 'We advanced a short distance northward and came across a fellow countryman. He was the only survivor of another shipwreck and he is very happy to see other humans again. We were also pleased; the man is a brewer. If we ever get into warlike disputes, beer will lift the courage of our people. A soldier needs much more than just a shield and a sword! \n\nThe man also tells us of ruins that he has discovered on the island. I fear that before long we will need to be more careful.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh2   = 'Advance into the interior of the island. Pay close attention to the supply of provisions and raw materials.',
        msg4    = 'We have found the ruins. They contained building plans for a watchtower. Now we should consider building fortifications. I am more convinced than ever that we are not alone on this island.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh4   = 'Advance into the interior of the island. Pay close attention to the supply of provisions and raw materials.',
        msg6    = ' We have found the ruins. They contained building plans for a watchtower. What is the origin of these structures? Who built them? I fear that peace will soon be at an end.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh6   = 'Advance into the interior of the island. Pay close attention to the supply of provisions and raw materials.',
        msg8    = 'Whoever is or was on this island knows all about the building trade. We found the ruins of a mighty fortress of exemplary construction. Our architects have already drawn up a building plan.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh8   = 'Advance into the interior of the island. Pay close attention to the supply of provisions and raw materials.',
        msg10   = '26th Day of the Third Month of the Second Year.\n\n\nMy fears have been given further confirmation. My men found a rag doll and two spear tips of the type customarily associated with the Nubian tribes. These artifacts do not appear to be very old.',
        msg12   = 'Our territory is expanding and transportation routes are becoming longer and longer. We must build a storehouse so that we can respond more quickly to the needs of our people.',
        msg14   = 'Diary of Octavius.\n\nFourth Day of the Fourth Month of the Second Year.\n\nIt was only to be expected: we came across the Nubians. At first everything was very friendly. They even told us about their holy relic and it quickly became obvious that it was one of the gateways. They denied us access to their holy relic, we shall have to fight to obtain access.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh14  = 'Attack the Nubians and gain access to their gateway.',
        msg16   = 'The Nubians are lousy fighters but they have a catapult, which we must destroy. Perhaps then we shall be able to capture plans showing how to build such a weapon.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh16  = 'Capture the catapult and then gain access to the gateway.',
        msg18   = '27th Day of the Ninth Month.\n\n\nWe were victorious in battle and the island is ours. The gateway has become active again. I am excited by the prospect of where our journey will take us now. The inscription on the gateway is in Latin. I hope that we will retrace the steps of our legendary predecessors when they journeyed to Rome...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh18  = 'You have completed this mission. The third Chapter awaits you...',
    },
    pl =
    {
        Diary   = 'Dziennik',
        msg0    = 'Trzeci Dzień Drugiego Roku.\n\n\nDotarliśmy do drugiej wyspy, która wydaje się być niezamieszkana. Zapas narzędzi wykonanych przez starego, dobrego Tortiusa jest powoli wyczerpywany. Pilnie potrzebujemy zakładów metalowych, aby wyprodukować nowe narzędzia.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh0   = 'Wybuduj zakłady metalowe i rozpocznij marsz do środka wyspy. Zwróć uwagę na dostawy surowców.',
        msg2    = 'Po krótkiej wyprawie na północ napotkaliśmy przyjaznego człowieka. Jak się okazało, jest on jedynym, którzy przeżył katastrofę swojego statku. Bardzo się ucieszył, widząc po tak długim czasie innych ludzi. My także mamy powód do radości; mężczyzna ten jest piwowarem. Jeśli kiedykolwiek wdamy się w wojenne dysputy, piwo zwiększy odwagę naszych ludzi. Dobry żołnierz potrzebuje tego bardziej, niż tarczy i miecza!\n\nMężczyzna mówił także o ruinach, jakie odkrył na wyspie. Obawiam się, że już wkrótce będziemy musieli stać się bardziej ostrożni.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh2   = 'Poruszaj się w stronę centrum wyspy. Zwracaj uwagę na dostawy surowców.',
        msg4    = 'Odnaleźliśmy ruiny, o których mówił nam napotkany mężczyzna. Znaleźliśmy w nich plany budowy wieży strażniczej. Powinniśmy rozważyć kwestię budowy fortyfikacji. Jestem przekonany, że nie jesteśmy sami na tej wyspie.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh4   = 'Poruszaj się w stronę centrum wyspy. Zwracaj uwagę na dostawy surowców.',
        msg6    = 'Odnaleźliśmy ruiny. Znaleźliśmy w nich plany budowy wieży strażniczej. Jakie jest pochodzenie tych budowli? Kto je wybudował? Lękam się, że nasz spokój zostanie wkrótce zakłócony.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh6   = 'Poruszaj się w stronę centrum wyspy. Zwracaj uwagę na dostawy surowców.',
        msg8    = 'Ktokolwiek postawił te budynki, doskonale znał się na swym fachu. Odnaleźliśmy ruiny potężnej fortecy, której konstrukcja zasługuje na miano wzorowej. Nasi architekci właśnie ukończyli szkicować plan budowli.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh8   = 'Poruszaj się w stronę centrum wyspy. Zwracaj uwagę na dostawy surowców.',
        msg10   = '26 Dzień Trzeciego Miesiąca Drugiego Roku.\n\n\nMoje obawy znalazły odzwierciedlenie w rzeczywistości. Moi ludzie znaleźli szmacianą lalkę i dwa groty włóczni, przywodzące na myśli te, jakich używają nubiańskie plemiona. Przedmioty te nie wydają się być zbyt stare.',
        msg12   = 'Nasze terytorium powiększa się i szlaki transportowe stają się coraz dłuższe i dłuższe. Musimy postawić magazyn, abyśmy byli w stanie szybciej i sprawniej reagować na potrzeby naszego ludu.',
        msg14   = 'Dziennik Oktawiana.\n\n4 Dzień Czwartego Miesiąca Drugiego Roku.\n\nTo była tylko kwestia czasu - natknęliśmy się na Nubian. Z początku wszystko przebiegało bardzo sprawnie i przyjaźnie. Opowiedzieli nam o swym świętym miejscu i szybko zorientowaliśmy się, że mówią o jednej z bram. Odmówili nam dostępu do ich świętego miejsca, a zatem będziemy musieli dostęp ten sobie wywalczyć.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh14  = 'Zaatakuj Nubian i zdobądź dostęp do ich bramy.',
        msg16   = 'Nubianie okazali się żałosnymi wojownikami, lecz w ich posiadaniu znajduje się katapulta, którą musimy koniecznie zniszczyć. Być może wtedy zdobędziemy plany budowy podobnej broni.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh16  = 'Zdobądź katapultę, a następnie dostęp do bramy.',
        msg18   = '27 Dzień Dziewiątego Miesiąca.\n\n\nWygraliśmy bitwę i wyspa jest teraz nasza. Brama zaś, na nowo stała się aktywna. Jestem podekscytowany na myśl o miejscach, gdzie tym razem możemy zostać przeniesieni. Inskrypcja na bramie wykonana jest po łacinie. Mam nadzieję, że podążymy śladami naszych wielkich przodków, gdy tamci podróżowali do Rzymu...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh18  = 'Ukończyłeś misję. Trzeci Rozdział oczekuje...',
    },
})

function getNumPlayers()
    return 2
end

-- boilerplate begin
function getRequiredLuaVersion()
    return 1
end

function isMapPreviewEnabled()
    return false
end

local requiredFeature = 4
function checkVersion()
    local featureLevel = rttr:GetFeatureLevel()
    if featureLevel < requiredFeature then
        rttr:MsgBox("LUA-Version Error", "Your Return to the Roots version is outdated. The required LUA-Feature level is " .. requiredFeature .. ", your version is " .. featureLevel .. ". The script can possibly crash or run unexpectedly!\n\nPlease update the game!", true)
    end
end

local isLoading = false
function showMissionText(e)
    if isLoading then return end

    local msg = _('msg' .. tostring(e))

    if msg ~= ('msg' .. tostring(e)) then
        local msgh = _('msgh' .. tostring(e))
        if msgh ~= ('msgh'.. tostring(e)) then
            rttr:MissionStatement(0, _('Diary'), msg .. '\n\n\n\n' .. msgh)
            rttr:SetMissionGoal(0, msgh)
        else
            rttr:MissionStatement(0, _('Diary'), msg)
        end
    else
        rttr:Log("Error: no Translation found: " .. msg)
    end
end

function enableBuilding(b)
    rttr:GetPlayer(0):EnableBuilding(b, not isLoading)
end

function getAllowedChanges()
    return
    {
        ["addonsAll"]   = false,
        ["ownNation"]   = false,
        ["ownColor"]    = false,
        ["ownTeam"]     = false,
        ["aiNation"]    = false,
        ["aiColor"]     = false,
        ["aiTeam"]      = false,
    }
end

local activeEvents = {}
local eventHistory = {}
local timesTriggered = {}

function onSave(saveGame)
    saveGame:PushInt(#eventHistory)
    for i = 1, #eventHistory do
        saveGame:PushInt(eventHistory[i])
    end
    return true
end

function onLoad(saveGame)
    local n = saveGame:PopInt()
    for i = 1, n do
        eventHistory[i] = saveGame:PopInt()
    end
    return true
end

function onSettingsReady()
    checkVersion()
    rttr:Log("-----------------------\n lua loaded... \n-----------------------\n")
    rttr:ResetAddons()
    rttr:SetAddon(ADDON_FRONTIER_DISTANCE_REACHABLE, true)
    rttr:SetGameSettings({
        ["fow"] = EXP_CLASSIC,
        ["teamView"] = false,
        ["lockedTeams"] = false
    })

    rttr:GetPlayer(0):SetNation(NAT_ROMANS)
    rttr:GetPlayer(0):SetColor(0)
-- boilerplate end

    rttr:GetPlayer(1):SetAI(3)
    rttr:GetPlayer(1):SetColor(1)
    rttr:GetPlayer(1):SetNation(NAT_AFRICANS)
    rttr:GetPlayer(1):SetName('Shaka')
 -- rttr:GetPlayer(1):SetPortrait(9)
end

function onStart(isFirstStart)
    -- world always commands

    -- player 0 always commands
    rttr:GetPlayer(0):DisableAllBuildings()
    rttr:GetPlayer(0):EnableBuilding(BLD_WOODCUTTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_FORESTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_QUARRY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_FISHERY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_HUNTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_SAWMILL, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_FARM, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_PIGFARM, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_DONKEYBREEDER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_SLAUGHTERHOUSE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_MILL, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_BAKERY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_IRONSMELTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_METALWORKS, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_ARMORY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_MINT, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_GOLDMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_IRONMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_COALMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_GRANITEMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_BARRACKS, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_WELL, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_WOODCUTTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_FORESTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_QUARRY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_FISHERY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_HUNTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_SAWMILL, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_FARM, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_PIGFARM, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_DONKEYBREEDER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_SLAUGHTERHOUSE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_MILL, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_BAKERY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_IRONSMELTER, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_METALWORKS, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_ARMORY, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_MINT, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_GOLDMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_IRONMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_COALMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_GRANITEMINE, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_BARRACKS, false)
    rttr:GetPlayer(0):EnableBuilding(BLD_WELL, false)

    -- player 1 always commands
    rttr:GetPlayer(1):EnableAllBuildings()

    -- events which need to be triggered multiple times

    -- events which are active right from the start
    activeEvents[ 0] = true
    activeEvents[ 1] = true
    activeEvents[ 2] = true
    activeEvents[ 3] = true
    activeEvents[ 4] = true
    activeEvents[ 5] = true
    activeEvents[ 6] = true
    activeEvents[10] = true
    activeEvents[20] = true
    activeEvents[21] = true
    activeEvents[30] = true
    activeEvents[99] = true

    if isFirstStart then
        -- world firststart commands
        rttr:GetWorld():AddAnimal(43, 24, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(16, 21, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(33, 50, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(33, 50, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(33, 50, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(29, 29, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(29, 29, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(29, 29, SPEC_DUCK)
        rttr:GetWorld():AddAnimal(16, 76, SPEC_RABBITWHITE)
        rttr:GetWorld():AddAnimal(16, 76, SPEC_RABBITWHITE)
        rttr:GetWorld():AddAnimal(16, 76, SPEC_RABBITWHITE)
        rttr:GetWorld():AddAnimal(17, 75, SPEC_RABBITGREY)
        rttr:GetWorld():AddAnimal(17, 75, SPEC_RABBITGREY)
        rttr:GetWorld():AddAnimal(17, 75, SPEC_RABBITGREY)

        -- player 0 firststart commands
        rttr:GetPlayer(0):PlaceHQ(14, 77)
        rttr:GetPlayer(0):ClearResources()

        -- player 1 firststart commands
        rttr:GetPlayer(1):MakeOneSidedAllianceTo(0)
        rttr:GetPlayer(1):PlaceHQ(44, 11)
        rttr:GetPlayer(1):AIConstructionOrder(41, 16, BLD_CATAPULT)
        rttr:GetPlayer(1):AIConstructionOrder(42, 18, BLD_WOODCUTTER)
        rttr:GetPlayer(1):AIConstructionOrder(43, 16, BLD_FORESTER)
        rttr:GetPlayer(1):AIConstructionOrder(45, 16, BLD_SAWMILL)
        rttr:GetPlayer(1):ClearResources()

        -- player 0 wares
        rttr:GetPlayer(0):AddWares({
            [GD_WOOD      ] = 0,
            [GD_BOARDS    ] = 50,
            [GD_STONES    ] = 50,
            [GD_MEAT      ] = 0,
            [GD_GRAIN     ] = 0,
            [GD_FLOUR     ] = 0,
            [GD_FISH      ] = 20,
            [GD_HAM       ] = 20,
            [GD_BREAD     ] = 20,
            [GD_WATER     ] = 10,
            [GD_BEER      ] = 0,
            [GD_COAL      ] = 10,
            [GD_IRONORE   ] = 0,
            [GD_GOLD      ] = 0,
            [GD_IRON      ] = 0,
            [GD_COINS     ] = 0,
            [GD_TONGS     ] = 0,
            [GD_AXE       ] = 0,
            [GD_SAW       ] = 0,
            [GD_PICKAXE   ] = 0,
            [GD_HAMMER    ] = 0,
            [GD_SHOVEL    ] = 0,
            [GD_CRUCIBLE  ] = 0,
            [GD_RODANDLINE] = 0,
            [GD_SCYTHE    ] = 0,
            [GD_CLEAVER   ] = 0,
            [GD_ROLLINGPIN] = 0,
            [GD_BOW       ] = 0,
            [GD_SWORD     ] = 10,
            [GD_SHIELD    ] = 10,
            [GD_BOAT      ] = 4,
        })

        -- player 1 wares
        rttr:GetPlayer(1):AddWares({
            [GD_WOOD      ] = 40,
            [GD_BOARDS    ] = 30,
            [GD_STONES    ] = 50,
            [GD_MEAT      ] = 0,
            [GD_GRAIN     ] = 0,
            [GD_FLOUR     ] = 0,
            [GD_FISH      ] = 30,
            [GD_HAM       ] = 1,
            [GD_BREAD     ] = 0,
            [GD_WATER     ] = 0,
            [GD_BEER      ] = 5,
            [GD_COAL      ] = 10,
            [GD_IRONORE   ] = 0,
            [GD_GOLD      ] = 0,
            [GD_IRON      ] = 0,
            [GD_COINS     ] = 0,
            [GD_TONGS     ] = 0,
            [GD_AXE       ] = 0,
            [GD_SAW       ] = 0,
            [GD_PICKAXE   ] = 0,
            [GD_HAMMER    ] = 0,
            [GD_SHOVEL    ] = 0,
            [GD_CRUCIBLE  ] = 0,
            [GD_RODANDLINE] = 0,
            [GD_SCYTHE    ] = 0,
            [GD_CLEAVER   ] = 0,
            [GD_ROLLINGPIN] = 0,
            [GD_BOW       ] = 0,
            [GD_SWORD     ] = 0,
            [GD_SHIELD    ] = 0,
            [GD_BOAT      ] = 0,
        })

        -- player 0 people
        rttr:GetPlayer(0):AddPeople({
            [JOB_HELPER           ] = 50,
            [JOB_WOODCUTTER       ] = 15,
            [JOB_FISHER           ] = 8,
            [JOB_FORESTER         ] = 10,
            [JOB_CARPENTER        ] = 5,
            [JOB_STONEMASON       ] = 5,
            [JOB_HUNTER           ] = 3,
            [JOB_FARMER           ] = 8,
            [JOB_MILLER           ] = 5,
            [JOB_BAKER            ] = 5,
            [JOB_BUTCHER          ] = 5,
            [JOB_MINER            ] = 10,
            [JOB_BREWER           ] = 1,
            [JOB_PIGBREEDER       ] = 5,
            [JOB_DONKEYBREEDER    ] = 5,
            [JOB_IRONFOUNDER      ] = 5,
            [JOB_MINTER           ] = 5,
            [JOB_METALWORKER      ] = 3,
            [JOB_ARMORER          ] = 3,
            [JOB_BUILDER          ] = 12,
            [JOB_PLANER           ] = 6,
            [JOB_GEOLOGIST        ] = 4,
            [JOB_PRIVATE          ] = 30,
            [JOB_PRIVATEFIRSTCLASS] = 0,
            [JOB_SERGEANT         ] = 0,
            [JOB_OFFICER          ] = 0,
            [JOB_GENERAL          ] = 0,
            [JOB_SCOUT            ] = 5,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 0,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- player 1 people
        rttr:GetPlayer(1):AddPeople({
            [JOB_HELPER           ] = 50,
            [JOB_WOODCUTTER       ] = 15,
            [JOB_FISHER           ] = 10,
            [JOB_FORESTER         ] = 10,
            [JOB_CARPENTER        ] = 10,
            [JOB_STONEMASON       ] = 10,
            [JOB_HUNTER           ] = 5,
            [JOB_FARMER           ] = 5,
            [JOB_MILLER           ] = 5,
            [JOB_BAKER            ] = 5,
            [JOB_BUTCHER          ] = 5,
            [JOB_MINER            ] = 10,
            [JOB_BREWER           ] = 5,
            [JOB_PIGBREEDER       ] = 5,
            [JOB_DONKEYBREEDER    ] = 5,
            [JOB_IRONFOUNDER      ] = 5,
            [JOB_MINTER           ] = 5,
            [JOB_METALWORKER      ] = 5,
            [JOB_ARMORER          ] = 5,
            [JOB_BUILDER          ] = 15,
            [JOB_PLANER           ] = 10,
            [JOB_GEOLOGIST        ] = 5,
            [JOB_PRIVATE          ] = 12,
            [JOB_PRIVATEFIRSTCLASS] = 0,
            [JOB_SERGEANT         ] = 0,
            [JOB_OFFICER          ] = 0,
            [JOB_GENERAL          ] = 0,
            [JOB_SCOUT            ] = 10,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 0,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- events which are triggered right from the start
        triggerEndEvent(4, 4)
    else
        isLoading = true
        for i = 1, #eventHistory, 2 do
            triggerEndEvent(eventHistory[i], eventHistory[i + 1])
        end
        isLoading = false
    end
end

function triggerEndEvent(e, trigger) -- events triggered from other events
    if not activeEvents[e] then return end

    if timesTriggered[e] then timesTriggered[e] = timesTriggered[e] + 1 end

    if false then -- dummy if
    elseif e == 0 then
        enableBuilding(BLD_GUARDHOUSE)
    elseif e == 1 then
        enableBuilding(BLD_WATCHTOWER)
    elseif e == 2 then
        enableBuilding(BLD_FORTRESS)
    elseif e == 3 then
        enableBuilding(BLD_BREWERY)
    elseif e == 4 then
        showMissionText(0)
    elseif e == 6 then
        enableBuilding(BLD_STOREHOUSE)
    elseif e == 21 then
        enableBuilding(BLD_CATAPULT)
    elseif e == 98 then
        rttr:GetWorld():AddStaticObject(48, 9, 561, 0xFFFF, 2)
    elseif e == 99 then
        activeEvents[98] = true
        showMissionText(18)
        rttr:SetCampaignChapterCompleted('roman', 2)
        rttr:EnableCampaignChapter('roman', 3)
    end

    if not isLoading then
        local n = #eventHistory
        eventHistory[n + 1] = e
        eventHistory[n + 2] = trigger
    end

    activeEvents[trigger] = false
end

function onGameFrame(gf)
    if activeEvents[6] and rttr:GetPlayer(0).GetStatisticsValue ~= nil and rttr:GetPlayer(0):GetStatisticsValue(STAT_COUNTRY) >= 800 then
        showMissionText(12)
        triggerEndEvent(6, 6)
    end
    if activeEvents[98] then
        triggerEndEvent(98, 98)
    end
end

function onExplored(p, x, y, o)
    if false then -- dummy if for onContact cases
    elseif activeEvents[10] and ((p == 0 and o == 1) or (p == 1 and o == 0)) then
        showMissionText(14)
        triggerEndEvent(10, 10)
    end

    if p ~= 0 then return
    elseif activeEvents[0] and x == 18 and y == 56 then
        showMissionText(4)
        triggerEndEvent(0, 0)
    elseif activeEvents[1] and x == 31 and y == 61 then
        showMissionText(6)
        triggerEndEvent(1, 1)
    elseif activeEvents[2] and x == 33 and y == 73 then
        showMissionText(8)
        triggerEndEvent(2, 2)
    elseif activeEvents[3] and x == 20 and y == 63 then
        showMissionText(2)
        triggerEndEvent(3, 3)
    elseif activeEvents[5] and x == 19 and y == 43 then
        showMissionText(10)
        triggerEndEvent(5, 5)
    elseif activeEvents[20] and x == 41 and y == 16 then
        showMissionText(16)
        triggerEndEvent(20, 20)
    end
end

function onOccupied(p, x, y)
    if p ~= 0 then return
    elseif activeEvents[21] and x == 41 and y == 16 then
        triggerEndEvent(21, 21)
    elseif activeEvents[30] and x == 48 and y == 9 then
        triggerEndEvent(30, 30)
        triggerEndEvent(99, 30)
    end
end

function onResourceFound(p, x, y, r, q)
    if p ~= 0 then return
    end
end

-- Generation end
