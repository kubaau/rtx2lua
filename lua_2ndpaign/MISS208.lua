-- Generation begin (https://github.com/kubaau/rtx2lua)

-- Original map script: MIS_0008.RTX

rttr:RegisterTranslations(
{
    de =
    {
        Diary   = 'Tagebuch',
        msg0    = 'IX - Weltherrschaft, von Jan Körner\n\nWir sind an einem Ort gelandet, den bisher keiner von uns gesehen hat, es handelt sich auf jeden Fall um unbekanntes Gebiet; auch die Pflanzen hier scheine ich nicht zu kennen. Wir sind bisher jedoch genau den Anweisungen des Plans gefolgt.\n\nWir sollten zunächst eine funktionierende Siedlung aufbauen, uns dabei aber beeilen; ich fühle, daß wir nicht mehr allzu viel Zeit übrig haben.\nMein Freund Marcus wird mich bei den militärischen Vorbereitungen beraten...\n\n\n\n\n\n\n\n\n\n',
        msgh0   = 'Bereitet Euch auf groß angelegte militärische Offensiven vor. Nutzt die vorhandenen Rohstoffe mit höchster Effizienz.\n\nSeid auf alles vorbereitet!',
        msg2    = 'Feindkontakt!\n\nDas Dominion weiß inzwischen, daß wir seine Pläne zur Invasion des Römischen Imperiums aufgedeckt haben und selbige verhindern wollen.\n\nVerhandlungen mit unserem Gegner waren somit von Beginn an zum Scheitern verurteilt.\n\nWir sollten unsere militärischen Kräfte so weit wie möglich an die Front verlegen um durchzubrechen. Der Weg direkt durch das Feindgebiet ist unsere einzige Möglichkeit vorzustoßen.\n\n\n\n\n\n\n\n\n\n',
        msg4    = 'Wir treffen auf sehr starke und aggressive Gegner...Auf diesem Kontinent liegt anscheinend das Hauptquartier dieses geheimnisvollen Militärbundes und damit auch der Schlüssel zu seiner Zerschlagung...\n\nIch selbst werde diesmal meine Mannen befehligen, wenn wir vorstoßen; eine Niederlage können wir uns nicht leisten.\n\nMarcus wird die zweite Front leiten und direkt zum anderen Volk, das die Vormacht über das Dominion inne hat, vordringen.\n\n\n\n\n\n\n\n\n\n\n',
        msgh4   = 'Sammelt Eure Kräfte; der Sieg ist nahe!',
        msg6    = 'Wir haben einen weiteren Kontinent erreicht.\n\nKriegsgefangene haben uns nach einiger "Überredungskunst" den Weg hierher gezeigt und berichtet, dies sei die einzige Möglichkeit, unsere Heimat zu retten.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh6   = 'Dringt in das Landesinnere vor...',
        msg8    = 'Darf man den Kriegsgefangenen glauben, so sind wir auf dem Kontinent gelandet, von dem aus das Dominion seine Herrschaft ausübt. Wir haben also mit energischem Widerstand zu rechnen.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh8   = 'Wagt Euch erst vor, wenn Ihr genug Kräfte für den Vorstoß gesammelt habt. Sorgt für den Schutz des Hafengebäudes.',
        msg10   = 'Tagebuch des Marcus:\n\nWir haben das Hauptquartier, welches ein weiteres Tor schützt, gefunden. Bevor das HQ zerstört wird, sollten wir uns in seinem Inneren umsehen, um vieleicht auch die letzten Geheimnisse der Tore zu entschlüsseln...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh10  = 'Rottet Eure letzten Kräfte zusammen, Ihr habt es bald geschafft!',
        msg12   = 'Tagebuch des Marcus:\n\nTraurige Nachrichten:\nWir haben das Hauptquartier des ersten Stammes zerschlagen, das Tor dürfte schon bald in unserem Besitz sein, auch haben wir eine genaue Bedienungsanleitung gefunden, die uns zeigt, wie wir auf direktem Wege nach Hause gelangen können.\nAber leider kam Octavianus beim Angriff auf das andere Volk ums Leben. Kraft meiner Position habe ich jetzt das Kommando über die Truppen...Ich wünschte, es wäre unter anderen Umständen geschehen...\n\n\n\n\n\n\n\n\n\n',
        msgh12  = 'Es gibt hier für Euch nichts weiter zu tun...\n\nIhr habt es geschaft, das Römische Imperium ist gerettet!',
        msg14   = "Man will uns einfach keine Erholung gönnen:\n\nWir haben das vermeintlich letzte Tor aktiviert, jedoch können wir Rom nur über einen Umweg über ein weiteres Tor erreichen.\n\n\n\n\n\nAuf geht's...\n\n\n\n\n\n\n\n\n\n\n\n\n",
        msgh14  = 'Ihr habt auch dieses Kapitel erfolgreich hinter Euch gebracht...',
    },
    en =
    {
        Diary   = 'Diary',
        msg0    = "IX - Basics\n\nWe've landed in a place unseen as yet by any of us. In any respect it is unknown territory; even the plants here I don't seem to recognize. However, we have followed the directions of the plan till now.\n\nAt first we should establish a working settlement, but make haste doing it.\nI feel that there is very little time to spare.\nMy friend Marcus will consult me in the military preparations...\n\n\n\n\n\n\n\n\n\n\n",
        msgh0   = 'Prepare for extensive military offensive. Make the most efficient use of the available material.\n\nBe ready for everything!',
        msg2    = 'Enemy contact!\n\nThe Dominion may meanwhile know that we are aware of their plans of invading the Roman Empire and that we are about to beat them to it.\n\nNegotiations with the adversary were therefore condemned to failure from the beginning.\n\nWe should advance our military forces as far as possible in order to break through. The direct path across enemy country is the only one for us to proceed.\n\n\n\n\n\n\n\n\n\n',
        msg4    = 'We ran into very strong and aggressive enemies ... On this continent the headquarters of this mysterious military alliance seem to be situated and at the same time the key to its undoing...\n\nI personally will command my men in the attack this time, we cannot risk defeat.\n\nMarcus will be in lead of a second frontline and advance directly to the other people, that has supremacy over the Dominion.\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh4   = 'Gather your forces; victory is at hand.',
        msg6    = 'We have reached another continent.\n\nPrisoners have shown us the way here after a bit of "persuasion" and conceded, this would be the only way to save our country.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh6   = 'Proceed to the interior...',
        msg8    = "If faith can be set in the prisoners' words, we have landed on the continent, from which the Dominion exercises its power. We therefore should take strong resistance into consideration.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        msgh8   = 'Only proceed after you have accumulated enough of force to dare attack. Make sure to protect your harbour.',
        msg10   = "Marcus' diary:\n\nWe found the headquarters safeguarding another gate. But before we destroy it, we will enter it to perhaps uncover the last secrets of the Gates.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        msgh10  = 'Band together your last forces. You nearly made it.',
        msg12   = "Marcus' diary:\n\nSad news:\nWe have taken the headquarters of the first tribe and the Gate should be in our hands within short. We also are in possession of a detailled manual, showing how we will return home straight away.\nBut unfortunately Octavianus lost his life in the attack on the other people. By virtue of my position I now hold the command of our forces ... I'd rather, it had happened under more fortunate circumstances ...\n\n\n\n\n\n\n\n\n\n\n",
        msgh12  = 'Here is nothing left for you to do ...\n\nYou have succeeded, the Roman Empire is safe!',
        msg14   = 'The Gods will not grant us any rest:\n\nWe activated what had seemed to be the last gate, but only by a detour through another Gate we can reach Rome.\n\n\n\n\n\nSo, on we go...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',
        msgh14  = 'Also this chapter you concluded successfully ...',
    },
})

function getNumPlayers()
    return 6
end

-- boilerplate begin
function getRequiredLuaVersion()
    return 1
end

function isMapPreviewEnabled()
    return false
end

local requiredFeature = 4
function checkVersion()
    local featureLevel = rttr:GetFeatureLevel()
    if featureLevel < requiredFeature then
        rttr:MsgBox("LUA-Version Error", "Your Return to the Roots version is outdated. The required LUA-Feature level is " .. requiredFeature .. ", your version is " .. featureLevel .. ". The script can possibly crash or run unexpectedly!\n\nPlease update the game!", true)
    end
end

local isLoading = false
function showMissionText(e)
    if isLoading then return end

    local msg = _('msg' .. tostring(e))

    if msg ~= ('msg' .. tostring(e)) then
        local msgh = _('msgh' .. tostring(e))
        if msgh ~= ('msgh'.. tostring(e)) then
            rttr:MissionStatement(0, _('Diary'), msg .. '\n\n\n\n' .. msgh)
            rttr:SetMissionGoal(0, msgh)
        else
            rttr:MissionStatement(0, _('Diary'), msg)
        end
    else
        rttr:Log("Error: no Translation found: " .. msg)
    end
end

function enableBuilding(b)
    rttr:GetPlayer(0):EnableBuilding(b, not isLoading)
end

function getAllowedChanges()
    return
    {
        ["addonsAll"]   = false,
        ["ownNation"]   = false,
        ["ownColor"]    = false,
        ["ownTeam"]     = false,
        ["aiNation"]    = false,
        ["aiColor"]     = false,
        ["aiTeam"]      = false,
    }
end

local activeEvents = {}
local eventHistory = {}
local timesTriggered = {}

function onSave(saveGame)
    saveGame:PushInt(#eventHistory)
    for i = 1, #eventHistory do
        saveGame:PushInt(eventHistory[i])
    end
    return true
end

function onLoad(saveGame)
    local n = saveGame:PopInt()
    for i = 1, n do
        eventHistory[i] = saveGame:PopInt()
    end
    return true
end

function onSettingsReady()
    checkVersion()
    rttr:Log("-----------------------\n lua loaded... \n-----------------------\n")
    rttr:ResetAddons()
    rttr:SetAddon(ADDON_CATAPULTS_ATTACK_ALLIES, true)
    rttr:SetAddon(ADDON_FRONTIER_DISTANCE_REACHABLE, true)
    rttr:SetGameSettings({
        ["fow"] = EXP_CLASSIC,
        ["teamView"] = false,
        ["lockedTeams"] = false
    })

    rttr:GetPlayer(0):SetNation(NAT_ROMANS)
    rttr:GetPlayer(0):SetColor(0)
-- boilerplate end

    rttr:GetPlayer(1):SetAI(3)
    rttr:GetPlayer(1):SetColor(1)
    rttr:GetPlayer(1):SetNation(NAT_VIKINGS)
    rttr:GetPlayer(1):SetName('Erik')
 -- rttr:GetPlayer(1):SetPortrait(3)

    rttr:GetPlayer(2):SetAI(3)
    rttr:GetPlayer(2):SetColor(2)
    rttr:GetPlayer(2):SetNation(NAT_VIKINGS)
    rttr:GetPlayer(2):SetName('Knut')
 -- rttr:GetPlayer(2):SetPortrait(4)

    rttr:GetPlayer(3):SetAI(3)
    rttr:GetPlayer(3):SetColor(3)
    rttr:GetPlayer(3):SetNation(NAT_VIKINGS)
    rttr:GetPlayer(3):SetName('Olof')
 -- rttr:GetPlayer(3):SetPortrait(5)

    rttr:GetPlayer(4):SetAI(3)
    rttr:GetPlayer(4):SetColor(4)
    rttr:GetPlayer(4):SetNation(NAT_JAPANESE)
    rttr:GetPlayer(4):SetName('Yamauchi')
 -- rttr:GetPlayer(4):SetPortrait(6)

    rttr:GetPlayer(5):SetAI(3)
    rttr:GetPlayer(5):SetColor(5)
    rttr:GetPlayer(5):SetNation(NAT_AFRICANS)
    rttr:GetPlayer(5):SetName('Todo')
 -- rttr:GetPlayer(5):SetPortrait(10)
end

function onStart(isFirstStart)
    -- world always commands
    rttr:GetWorld():SetComputerBarrier(20, 71, 80)
    rttr:GetWorld():SetComputerBarrier(20, 232, 29)
    rttr:GetWorld():SetComputerBarrier(20, 135, 57)

    -- player 0 always commands
    rttr:GetPlayer(0):DisableAllBuildings()
    rttr:GetPlayer(0):EnableAllBuildings()

    -- player 1 always commands
    rttr:GetPlayer(1):EnableAllBuildings()

    -- player 2 always commands
    rttr:GetPlayer(2):EnableAllBuildings()

    -- player 3 always commands
    rttr:GetPlayer(3):EnableAllBuildings()

    -- player 4 always commands
    rttr:GetPlayer(4):EnableAllBuildings()

    -- player 5 always commands
    rttr:GetPlayer(5):EnableAllBuildings()

    -- events which need to be triggered multiple times

    -- events which are active right from the start
    activeEvents[ 0] = true
    activeEvents[ 1] = true
    activeEvents[ 2] = true
    activeEvents[ 3] = true
    activeEvents[ 4] = true
    activeEvents[ 5] = true
    activeEvents[ 6] = true
    activeEvents[ 7] = true
    activeEvents[ 8] = true
    activeEvents[30] = true
    activeEvents[99] = true

    if isFirstStart then
        -- world firststart commands

        -- player 0 firststart commands
        rttr:GetPlayer(0):PlaceHQ(45, 23)
        rttr:GetPlayer(0):ClearResources()

        -- player 1 firststart commands
        rttr:GetPlayer(1):MakeOneSidedAllianceTo(2)
        rttr:GetPlayer(1):MakeOneSidedAllianceTo(3)
        rttr:GetPlayer(1):MakeOneSidedAllianceTo(4)
        rttr:GetPlayer(1):MakeOneSidedAllianceTo(5)
        rttr:GetPlayer(1):PlaceHQ(147, 23)
        rttr:GetPlayer(1):ClearResources()

        -- player 2 firststart commands
        rttr:GetPlayer(2):MakeOneSidedAllianceTo(1)
        rttr:GetPlayer(2):MakeOneSidedAllianceTo(3)
        rttr:GetPlayer(2):MakeOneSidedAllianceTo(4)
        rttr:GetPlayer(2):MakeOneSidedAllianceTo(5)
        rttr:GetPlayer(2):PlaceHQ(78, 133)
        rttr:GetPlayer(2):ClearResources()

        -- player 3 firststart commands
        rttr:GetPlayer(3):MakeOneSidedAllianceTo(1)
        rttr:GetPlayer(3):MakeOneSidedAllianceTo(2)
        rttr:GetPlayer(3):MakeOneSidedAllianceTo(4)
        rttr:GetPlayer(3):MakeOneSidedAllianceTo(5)
        rttr:GetPlayer(3):PlaceHQ(153, 95)
        rttr:GetPlayer(3):AIConstructionOrder(153, 99, BLD_FORTRESS)
        rttr:GetPlayer(3):AIConstructionOrder(151, 98, BLD_FORTRESS)
        rttr:GetPlayer(3):AIConstructionOrder(151, 92, BLD_FORTRESS)
        rttr:GetPlayer(3):ClearResources()

        -- player 4 firststart commands
        rttr:GetPlayer(4):MakeOneSidedAllianceTo(1)
        rttr:GetPlayer(4):MakeOneSidedAllianceTo(2)
        rttr:GetPlayer(4):MakeOneSidedAllianceTo(3)
        rttr:GetPlayer(4):MakeOneSidedAllianceTo(5)
        rttr:GetPlayer(4):PlaceHQ(148, 117)
        rttr:GetPlayer(4):AIConstructionOrder(146, 115, BLD_FORTRESS)
        rttr:GetPlayer(4):AIConstructionOrder(149, 114, BLD_FORTRESS)
        rttr:GetPlayer(4):AIConstructionOrder(151, 117, BLD_FORTRESS)
        rttr:GetPlayer(4):AIConstructionOrder(149, 120, BLD_FORTRESS)
        rttr:GetPlayer(4):ClearResources()

        -- player 5 firststart commands
        rttr:GetPlayer(5):MakeOneSidedAllianceTo(1)
        rttr:GetPlayer(5):MakeOneSidedAllianceTo(2)
        rttr:GetPlayer(5):MakeOneSidedAllianceTo(3)
        rttr:GetPlayer(5):MakeOneSidedAllianceTo(4)
        rttr:GetPlayer(5):PlaceHQ(198, 60)
        rttr:GetPlayer(5):ClearResources()

        -- player 0 wares
        rttr:GetPlayer(0):AddWares({
            [GD_WOOD      ] = 0,
            [GD_BOARDS    ] = 25,
            [GD_STONES    ] = 25,
            [GD_MEAT      ] = 0,
            [GD_GRAIN     ] = 0,
            [GD_FLOUR     ] = 0,
            [GD_FISH      ] = 0,
            [GD_HAM       ] = 0,
            [GD_BREAD     ] = 0,
            [GD_WATER     ] = 0,
            [GD_BEER      ] = 0,
            [GD_COAL      ] = 25,
            [GD_IRONORE   ] = 10,
            [GD_GOLD      ] = 0,
            [GD_IRON      ] = 5,
            [GD_COINS     ] = 10,
            [GD_TONGS     ] = 1,
            [GD_AXE       ] = 2,
            [GD_SAW       ] = 1,
            [GD_PICKAXE   ] = 3,
            [GD_HAMMER    ] = 5,
            [GD_SHOVEL    ] = 4,
            [GD_CRUCIBLE  ] = 0,
            [GD_RODANDLINE] = 2,
            [GD_SCYTHE    ] = 5,
            [GD_CLEAVER   ] = 1,
            [GD_ROLLINGPIN] = 1,
            [GD_BOW       ] = 1,
            [GD_SWORD     ] = 0,
            [GD_SHIELD    ] = 0,
            [GD_BOAT      ] = 0,
        })

        -- player 1 wares
        rttr:GetPlayer(1):AddWares({
            [GD_WOOD      ] = 100,
            [GD_BOARDS    ] = 50,
            [GD_STONES    ] = 50,
            [GD_MEAT      ] = 20,
            [GD_GRAIN     ] = 20,
            [GD_FLOUR     ] = 20,
            [GD_FISH      ] = 20,
            [GD_HAM       ] = 20,
            [GD_BREAD     ] = 15,
            [GD_WATER     ] = 0,
            [GD_BEER      ] = 24,
            [GD_COAL      ] = 60,
            [GD_IRONORE   ] = 0,
            [GD_GOLD      ] = 0,
            [GD_IRON      ] = 30,
            [GD_COINS     ] = 20,
            [GD_TONGS     ] = 1,
            [GD_AXE       ] = 6,
            [GD_SAW       ] = 3,
            [GD_PICKAXE   ] = 3,
            [GD_HAMMER    ] = 6,
            [GD_SHOVEL    ] = 4,
            [GD_CRUCIBLE  ] = 2,
            [GD_RODANDLINE] = 6,
            [GD_SCYTHE    ] = 6,
            [GD_CLEAVER   ] = 2,
            [GD_ROLLINGPIN] = 2,
            [GD_BOW       ] = 2,
            [GD_SWORD     ] = 15,
            [GD_SHIELD    ] = 15,
            [GD_BOAT      ] = 0,
        })

        -- player 2 wares
        rttr:GetPlayer(2):AddWares({
            [GD_WOOD      ] = 50,
            [GD_BOARDS    ] = 40,
            [GD_STONES    ] = 40,
            [GD_MEAT      ] = 25,
            [GD_GRAIN     ] = 25,
            [GD_FLOUR     ] = 25,
            [GD_FISH      ] = 25,
            [GD_HAM       ] = 25,
            [GD_BREAD     ] = 25,
            [GD_WATER     ] = 0,
            [GD_BEER      ] = 12,
            [GD_COAL      ] = 40,
            [GD_IRONORE   ] = 0,
            [GD_GOLD      ] = 10,
            [GD_IRON      ] = 15,
            [GD_COINS     ] = 10,
            [GD_TONGS     ] = 2,
            [GD_AXE       ] = 6,
            [GD_SAW       ] = 2,
            [GD_PICKAXE   ] = 6,
            [GD_HAMMER    ] = 12,
            [GD_SHOVEL    ] = 12,
            [GD_CRUCIBLE  ] = 3,
            [GD_RODANDLINE] = 6,
            [GD_SCYTHE    ] = 15,
            [GD_CLEAVER   ] = 3,
            [GD_ROLLINGPIN] = 3,
            [GD_BOW       ] = 2,
            [GD_SWORD     ] = 20,
            [GD_SHIELD    ] = 20,
            [GD_BOAT      ] = 0,
        })

        -- player 3 wares
        rttr:GetPlayer(3):AddWares({
            [GD_WOOD      ] = 50,
            [GD_BOARDS    ] = 40,
            [GD_STONES    ] = 40,
            [GD_MEAT      ] = 25,
            [GD_GRAIN     ] = 25,
            [GD_FLOUR     ] = 25,
            [GD_FISH      ] = 25,
            [GD_HAM       ] = 25,
            [GD_BREAD     ] = 25,
            [GD_WATER     ] = 0,
            [GD_BEER      ] = 12,
            [GD_COAL      ] = 40,
            [GD_IRONORE   ] = 0,
            [GD_GOLD      ] = 10,
            [GD_IRON      ] = 15,
            [GD_COINS     ] = 10,
            [GD_TONGS     ] = 2,
            [GD_AXE       ] = 6,
            [GD_SAW       ] = 2,
            [GD_PICKAXE   ] = 6,
            [GD_HAMMER    ] = 12,
            [GD_SHOVEL    ] = 12,
            [GD_CRUCIBLE  ] = 3,
            [GD_RODANDLINE] = 6,
            [GD_SCYTHE    ] = 15,
            [GD_CLEAVER   ] = 3,
            [GD_ROLLINGPIN] = 3,
            [GD_BOW       ] = 2,
            [GD_SWORD     ] = 20,
            [GD_SHIELD    ] = 20,
            [GD_BOAT      ] = 0,
        })

        -- player 4 wares
        rttr:GetPlayer(4):AddWares({
            [GD_WOOD      ] = 50,
            [GD_BOARDS    ] = 40,
            [GD_STONES    ] = 40,
            [GD_MEAT      ] = 25,
            [GD_GRAIN     ] = 25,
            [GD_FLOUR     ] = 25,
            [GD_FISH      ] = 25,
            [GD_HAM       ] = 25,
            [GD_BREAD     ] = 25,
            [GD_WATER     ] = 0,
            [GD_BEER      ] = 12,
            [GD_COAL      ] = 40,
            [GD_IRONORE   ] = 0,
            [GD_GOLD      ] = 10,
            [GD_IRON      ] = 15,
            [GD_COINS     ] = 10,
            [GD_TONGS     ] = 2,
            [GD_AXE       ] = 6,
            [GD_SAW       ] = 2,
            [GD_PICKAXE   ] = 6,
            [GD_HAMMER    ] = 12,
            [GD_SHOVEL    ] = 12,
            [GD_CRUCIBLE  ] = 3,
            [GD_RODANDLINE] = 6,
            [GD_SCYTHE    ] = 15,
            [GD_CLEAVER   ] = 3,
            [GD_ROLLINGPIN] = 3,
            [GD_BOW       ] = 2,
            [GD_SWORD     ] = 20,
            [GD_SHIELD    ] = 20,
            [GD_BOAT      ] = 0,
        })

        -- player 5 wares
        rttr:GetPlayer(5):AddWares({
            [GD_WOOD      ] = 50,
            [GD_BOARDS    ] = 40,
            [GD_STONES    ] = 40,
            [GD_MEAT      ] = 25,
            [GD_GRAIN     ] = 25,
            [GD_FLOUR     ] = 25,
            [GD_FISH      ] = 25,
            [GD_HAM       ] = 25,
            [GD_BREAD     ] = 25,
            [GD_WATER     ] = 0,
            [GD_BEER      ] = 12,
            [GD_COAL      ] = 40,
            [GD_IRONORE   ] = 0,
            [GD_GOLD      ] = 10,
            [GD_IRON      ] = 15,
            [GD_COINS     ] = 10,
            [GD_TONGS     ] = 2,
            [GD_AXE       ] = 6,
            [GD_SAW       ] = 2,
            [GD_PICKAXE   ] = 6,
            [GD_HAMMER    ] = 12,
            [GD_SHOVEL    ] = 12,
            [GD_CRUCIBLE  ] = 3,
            [GD_RODANDLINE] = 6,
            [GD_SCYTHE    ] = 15,
            [GD_CLEAVER   ] = 3,
            [GD_ROLLINGPIN] = 3,
            [GD_BOW       ] = 2,
            [GD_SWORD     ] = 20,
            [GD_SHIELD    ] = 20,
            [GD_BOAT      ] = 0,
        })

        -- player 0 people
        rttr:GetPlayer(0):AddPeople({
            [JOB_HELPER           ] = 99,
            [JOB_WOODCUTTER       ] = 2,
            [JOB_FISHER           ] = 1,
            [JOB_FORESTER         ] = 1,
            [JOB_CARPENTER        ] = 1,
            [JOB_STONEMASON       ] = 2,
            [JOB_HUNTER           ] = 0,
            [JOB_FARMER           ] = 2,
            [JOB_MILLER           ] = 1,
            [JOB_BAKER            ] = 1,
            [JOB_BUTCHER          ] = 1,
            [JOB_MINER            ] = 2,
            [JOB_BREWER           ] = 0,
            [JOB_PIGBREEDER       ] = 0,
            [JOB_DONKEYBREEDER    ] = 0,
            [JOB_IRONFOUNDER      ] = 1,
            [JOB_MINTER           ] = 1,
            [JOB_METALWORKER      ] = 0,
            [JOB_ARMORER          ] = 0,
            [JOB_BUILDER          ] = 3,
            [JOB_PLANER           ] = 2,
            [JOB_GEOLOGIST        ] = 3,
            [JOB_PRIVATE          ] = 20,
            [JOB_PRIVATEFIRSTCLASS] = 11,
            [JOB_SERGEANT         ] = 6,
            [JOB_OFFICER          ] = 3,
            [JOB_GENERAL          ] = 3,
            [JOB_SCOUT            ] = 2,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 0,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- player 1 people
        rttr:GetPlayer(1):AddPeople({
            [JOB_HELPER           ] = 99,
            [JOB_WOODCUTTER       ] = 8,
            [JOB_FISHER           ] = 4,
            [JOB_FORESTER         ] = 3,
            [JOB_CARPENTER        ] = 2,
            [JOB_STONEMASON       ] = 6,
            [JOB_HUNTER           ] = 3,
            [JOB_FARMER           ] = 4,
            [JOB_MILLER           ] = 3,
            [JOB_BAKER            ] = 2,
            [JOB_BUTCHER          ] = 2,
            [JOB_MINER            ] = 5,
            [JOB_BREWER           ] = 1,
            [JOB_PIGBREEDER       ] = 1,
            [JOB_DONKEYBREEDER    ] = 1,
            [JOB_IRONFOUNDER      ] = 2,
            [JOB_MINTER           ] = 1,
            [JOB_METALWORKER      ] = 1,
            [JOB_ARMORER          ] = 1,
            [JOB_BUILDER          ] = 6,
            [JOB_PLANER           ] = 7,
            [JOB_GEOLOGIST        ] = 3,
            [JOB_PRIVATE          ] = 40,
            [JOB_PRIVATEFIRSTCLASS] = 40,
            [JOB_SERGEANT         ] = 40,
            [JOB_OFFICER          ] = 20,
            [JOB_GENERAL          ] = 20,
            [JOB_SCOUT            ] = 6,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 20,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- player 2 people
        rttr:GetPlayer(2):AddPeople({
            [JOB_HELPER           ] = 99,
            [JOB_WOODCUTTER       ] = 12,
            [JOB_FISHER           ] = 6,
            [JOB_FORESTER         ] = 4,
            [JOB_CARPENTER        ] = 3,
            [JOB_STONEMASON       ] = 12,
            [JOB_HUNTER           ] = 3,
            [JOB_FARMER           ] = 12,
            [JOB_MILLER           ] = 5,
            [JOB_BAKER            ] = 5,
            [JOB_BUTCHER          ] = 5,
            [JOB_MINER            ] = 12,
            [JOB_BREWER           ] = 1,
            [JOB_PIGBREEDER       ] = 1,
            [JOB_DONKEYBREEDER    ] = 1,
            [JOB_IRONFOUNDER      ] = 2,
            [JOB_MINTER           ] = 2,
            [JOB_METALWORKER      ] = 1,
            [JOB_ARMORER          ] = 2,
            [JOB_BUILDER          ] = 12,
            [JOB_PLANER           ] = 12,
            [JOB_GEOLOGIST        ] = 6,
            [JOB_PRIVATE          ] = 30,
            [JOB_PRIVATEFIRSTCLASS] = 25,
            [JOB_SERGEANT         ] = 20,
            [JOB_OFFICER          ] = 10,
            [JOB_GENERAL          ] = 5,
            [JOB_SCOUT            ] = 4,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 20,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- player 3 people
        rttr:GetPlayer(3):AddPeople({
            [JOB_HELPER           ] = 99,
            [JOB_WOODCUTTER       ] = 12,
            [JOB_FISHER           ] = 6,
            [JOB_FORESTER         ] = 4,
            [JOB_CARPENTER        ] = 3,
            [JOB_STONEMASON       ] = 12,
            [JOB_HUNTER           ] = 3,
            [JOB_FARMER           ] = 12,
            [JOB_MILLER           ] = 5,
            [JOB_BAKER            ] = 5,
            [JOB_BUTCHER          ] = 5,
            [JOB_MINER            ] = 12,
            [JOB_BREWER           ] = 1,
            [JOB_PIGBREEDER       ] = 1,
            [JOB_DONKEYBREEDER    ] = 1,
            [JOB_IRONFOUNDER      ] = 2,
            [JOB_MINTER           ] = 2,
            [JOB_METALWORKER      ] = 1,
            [JOB_ARMORER          ] = 2,
            [JOB_BUILDER          ] = 12,
            [JOB_PLANER           ] = 12,
            [JOB_GEOLOGIST        ] = 6,
            [JOB_PRIVATE          ] = 50,
            [JOB_PRIVATEFIRSTCLASS] = 45,
            [JOB_SERGEANT         ] = 40,
            [JOB_OFFICER          ] = 35,
            [JOB_GENERAL          ] = 30,
            [JOB_SCOUT            ] = 4,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 20,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- player 4 people
        rttr:GetPlayer(4):AddPeople({
            [JOB_HELPER           ] = 99,
            [JOB_WOODCUTTER       ] = 12,
            [JOB_FISHER           ] = 6,
            [JOB_FORESTER         ] = 4,
            [JOB_CARPENTER        ] = 3,
            [JOB_STONEMASON       ] = 12,
            [JOB_HUNTER           ] = 3,
            [JOB_FARMER           ] = 12,
            [JOB_MILLER           ] = 5,
            [JOB_BAKER            ] = 5,
            [JOB_BUTCHER          ] = 5,
            [JOB_MINER            ] = 12,
            [JOB_BREWER           ] = 1,
            [JOB_PIGBREEDER       ] = 1,
            [JOB_DONKEYBREEDER    ] = 1,
            [JOB_IRONFOUNDER      ] = 2,
            [JOB_MINTER           ] = 2,
            [JOB_METALWORKER      ] = 1,
            [JOB_ARMORER          ] = 2,
            [JOB_BUILDER          ] = 12,
            [JOB_PLANER           ] = 12,
            [JOB_GEOLOGIST        ] = 6,
            [JOB_PRIVATE          ] = 50,
            [JOB_PRIVATEFIRSTCLASS] = 45,
            [JOB_SERGEANT         ] = 40,
            [JOB_OFFICER          ] = 35,
            [JOB_GENERAL          ] = 30,
            [JOB_SCOUT            ] = 4,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 20,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- player 5 people
        rttr:GetPlayer(5):AddPeople({
            [JOB_HELPER           ] = 99,
            [JOB_WOODCUTTER       ] = 12,
            [JOB_FISHER           ] = 6,
            [JOB_FORESTER         ] = 4,
            [JOB_CARPENTER        ] = 3,
            [JOB_STONEMASON       ] = 12,
            [JOB_HUNTER           ] = 3,
            [JOB_FARMER           ] = 12,
            [JOB_MILLER           ] = 5,
            [JOB_BAKER            ] = 5,
            [JOB_BUTCHER          ] = 5,
            [JOB_MINER            ] = 12,
            [JOB_BREWER           ] = 1,
            [JOB_PIGBREEDER       ] = 1,
            [JOB_DONKEYBREEDER    ] = 1,
            [JOB_IRONFOUNDER      ] = 2,
            [JOB_MINTER           ] = 2,
            [JOB_METALWORKER      ] = 1,
            [JOB_ARMORER          ] = 2,
            [JOB_BUILDER          ] = 12,
            [JOB_PLANER           ] = 12,
            [JOB_GEOLOGIST        ] = 6,
            [JOB_PRIVATE          ] = 20,
            [JOB_PRIVATEFIRSTCLASS] = 15,
            [JOB_SERGEANT         ] = 10,
            [JOB_OFFICER          ] = 10,
            [JOB_GENERAL          ] = 5,
            [JOB_SCOUT            ] = 4,
            [JOB_SHIPWRIGHT       ] = 0,
            [JOB_PACKDONKEY       ] = 20,
            [JOB_BOATCARRIER      ] = 0,
            [JOB_CHARBURNER       ] = 0,
        })

        -- events which are triggered right from the start
        triggerEndEvent(0, 0)
    else
        isLoading = true
        for i = 1, #eventHistory, 2 do
            triggerEndEvent(eventHistory[i], eventHistory[i + 1])
        end
        isLoading = false
    end
end

function triggerEndEvent(e, trigger) -- events triggered from other events
    if not activeEvents[e] then return end

    if timesTriggered[e] then timesTriggered[e] = timesTriggered[e] + 1 end

    if false then -- dummy if
    elseif e == 0 then
        showMissionText(0)
    elseif e == 2 then
        activeEvents[97] = true
    elseif e == 98 then
        rttr:GetWorld():AddStaticObject(147, 120, 561, 0xFFFF, 2)
    elseif e == 99 then
        activeEvents[98] = true
        showMissionText(14)
        rttr:SetCampaignChapterCompleted('2NDpaign', 8)
        rttr:EnableCampaignChapter('2NDpaign', 9)
    end

    if not isLoading then
        local n = #eventHistory
        eventHistory[n + 1] = e
        eventHistory[n + 2] = trigger
    end

    activeEvents[trigger] = false
end

function onGameFrame(gf)
    if activeEvents[98] then
        triggerEndEvent(98, 98)
    end
end

function onExplored(p, x, y, o)
    if false then -- dummy if for onContact cases
    elseif activeEvents[3] and ((p == 0 and o == 2) or (p == 2 and o == 0)) then
        showMissionText(2)
        triggerEndEvent(3, 3)
    elseif activeEvents[4] and ((p == 0 and o == 3) or (p == 3 and o == 0)) then
        showMissionText(4)
        triggerEndEvent(4, 4)
    end

    if p ~= 0 then return
    elseif activeEvents[5] and x == 232 and y == 29 then
        showMissionText(6)
        triggerEndEvent(5, 5)
    elseif activeEvents[6] and x == 135 and y == 57 then
        showMissionText(8)
        triggerEndEvent(6, 6)
    elseif activeEvents[7] and x == 148 and y == 117 then
        showMissionText(10)
        triggerEndEvent(7, 7)
    end
end

function onOccupied(p, x, y)
    if p ~= 0 then return
    elseif activeEvents[1] and x == 121 and y == 20 then
        triggerEndEvent(1, 1)
        triggerEndEvent(2, 1)
    elseif activeEvents[8] and x == 153 and y == 95 then
        showMissionText(12)
        triggerEndEvent(8, 8)
    elseif activeEvents[30] and x == 147 and y == 120 then
        triggerEndEvent(30, 30)
        triggerEndEvent(99, 30)
    end
end

function onResourceFound(p, x, y, r, q)
    if p ~= 0 then return
    end
end

-- Generation end
